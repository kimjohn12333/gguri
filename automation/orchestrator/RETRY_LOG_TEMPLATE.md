# Retry Log Template

오케스트레이터 작업 실패/재시도 이력을 일관되게 남기기 위한 템플릿입니다.

## 사용 방법
- 실패가 발생하면 먼저 **실패 유형(일시적/영구)** 을 분류합니다.
- 일시적 실패는 재시도 시도별 로그를 남기고, 성공/최종 실패를 기록합니다.
- 영구 실패는 재시도 없이 원인과 후속 조치(사람 개입 필요 여부)를 명확히 기록합니다.

---

## 1) 일시적 실패(Transient) 기록 템플릿

```markdown
### [RETRY] <작업ID> - <작업명>
- 발생 시각(KST): <YYYY-MM-DD HH:mm>
- 실패 유형: 일시적(Transient)
- 증상/에러 요약: <짧은 설명>
- 추정 원인: <네트워크 지연/일시적 API 오류/잠금 충돌 등>
- 영향 범위: <영향 받은 파일/프로세스/사용자 영향>

#### 재시도 이력
| 시도 | 시각(KST) | 조치 | 결과 |
|---|---|---|---|
| 1 | <HH:mm> | <재시도/백오프/파라미터 수정 등> | <실패/성공> |
| 2 | <HH:mm> | <...> | <실패/성공> |
| 3 | <HH:mm> | <...> | <실패/성공> |

- 최종 상태: <성공/최종 실패>
- 복구 여부: <완전 복구/부분 복구/미복구>
- 후속 조치: <모니터링/재발 방지/룰 수정>
- 기록자: <agent/session>
```

---

## 2) 영구 실패(Permanent) 기록 템플릿

```markdown
### [FAIL] <작업ID> - <작업명>
- 발생 시각(KST): <YYYY-MM-DD HH:mm>
- 실패 유형: 영구(Permanent)
- 증상/에러 요약: <짧은 설명>
- 근본 원인: <권한 부족/잘못된 입력/리소스 부재/정책 차단 등>
- 재시도 비실시 사유: <재시도해도 성공 가능성 낮은 이유>
- 영향 범위: <영향 받은 파일/프로세스/사용자 영향>
- 사람 개입 필요: <예/아니오>
- 요청 사항(필요 시): <권한 부여/입력값 확인/정책 예외 승인 등>
- 최종 상태: 최종 실패
- 기록자: <agent/session>
```

---

## 3) 실제 기록 예시

### 예시 A — 재시도 성공 (일시적 실패)

```markdown
### [RETRY] ORCH-017 - 야간 요약 리포트 생성
- 발생 시각(KST): 2026-02-07 01:05
- 실패 유형: 일시적(Transient)
- 증상/에러 요약: 외부 검색 API 502 응답 발생
- 추정 원인: 공급자 측 일시 장애
- 영향 범위: 리포트 생성 지연(최대 5분), 데이터 유실 없음

#### 재시도 이력
| 시도 | 시각(KST) | 조치 | 결과 |
|---|---|---|---|
| 1 | 01:05 | 즉시 재시도 | 실패(502) |
| 2 | 01:06 | 1분 백오프 후 재시도 | 성공 |

- 최종 상태: 성공
- 복구 여부: 완전 복구
- 후속 조치: 동일 에러 3회 연속 시 대체 데이터 소스 사용하도록 룰 추가 검토
- 기록자: agent:main:subagent:retry-worker-01
```

### 예시 B — 최종 실패 (영구 실패)

```markdown
### [FAIL] ORCH-021 - 외부 채널 알림 전송
- 발생 시각(KST): 2026-02-07 09:12
- 실패 유형: 영구(Permanent)
- 증상/에러 요약: 메시지 전송 권한 없음(403 Forbidden)
- 근본 원인: 대상 채널에서 봇 권한 제거됨
- 재시도 비실시 사유: 권한 복구 전까지 재시도해도 동일 실패
- 영향 범위: 알림 미전송 1건
- 사람 개입 필요: 예
- 요청 사항(필요 시): 채널 관리자에게 bot send 권한 재부여 요청
- 최종 상태: 최종 실패
- 기록자: agent:main:subagent:notify-worker-02
```
